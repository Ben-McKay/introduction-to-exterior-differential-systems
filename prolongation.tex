\chapter{Prolongation}\label{chapter:prolongation}
\chapterSummary{In our next example, we will see what to do when the Cartan--K\"ahler theorem does not apply to an exterior differential system.}%
\section{Notation}In this chapter, for convenience of notation, we drop our convention of writing \(\omega^{12}\) to mean \(\omega^1\wedge\omega^2\) etc.
We use freely the notation and terminology of appendix~\ref{chapter:moving.frame}. 
\section{Example: isometric immersion, involution fails}
Take a surface \(S\) in \(3\)-dimensional Euclidean space \(\E[3]\).
Naturally we are curious to bend the surface, without stretching it or squishing it.
An \emph{isometric immersion} \(\varphi \colon S \to \E[3]\) is a map preserving the lengths of all curves on \(S\), i.e. not stretching or squishing.
\begin{example}This surface (viewed from various angles)
\begin{center}
\includegraphicsinexample[width=9cm]
{integrate-differential}
\end{center}
is the image of an isometric immersion of a piece of this paraboloid
\begin{center}
\includegraphicsinexample[width=1cm]{parabola}
\end{center}
\end{example}
On the frame bundle \(\frameBundle{S}\) of oriented orthonormal frames, denote the soldering forms as \(\pf=\pf_1+i\pf_2\) and the connection by \(1\)-form) \(\alpha\) so that \(d\pf=i\alpha \wedge \pf\) and \(d\alpha=(i/2)K\pf \wedge \bar\pf\).
On \(\frameBundleE{3}\) there is a soldering \(1\)-form \(\qf_i\) and a connection \(1\)-form \(\qc_{ij}\) so that \(d\qf_i = -\qc_{ij} \wedge \qf_j\) and \(d\qc_{ij} = -\qc_{ik} \wedge \qc_{kj}\).
Let \(\otalpha\defeq\qc_{12}\).

Suppose that there is an isometric immersion \(\varphi \colon S \to \E[3]\).
Its \emph{adapted frame bundle}\define{adapted!frame bundle}\define{frame bundle!adapted} \(X\defeq X_{\varphi} \subset M \defeq \frameBundle{S} \times \frameBundleE{3}\) is the set of all tuples
\[
\pr{x,e_1,e_2,\ot{x},\ot{e}_1,\ot{e}_2,\ot{e}_3}
\]
where \(x \in S\) with orthonormal frame \(e_1, e_2 \in T_x S\) and \(\ot{x} \in \E[3]\) with orthonormal frames \(\ot{e}_1, \ot{e}_2, \ot{e}_3 \in T_{\ot{x}} \E[3]\), so that \(\varphi_* e_1=\ot{e}_1\) and \(\varphi_* e_2=\ot{e}_2\).
Let \(\II\) be the exterior differential system on \(M\) generated by the \(1\)-forms
\[
\begin{pmatrix}
\theta_1 \\
\theta_2 \\
\theta_3
\end{pmatrix}
\defeq
\begin{pmatrix}
\qf_1-\pf_1 \\
\qf_2-\pf_2 \\
\qf_3
\end{pmatrix}.
\]
Along \(X\), all of these \(1\)-forms vanish, while the \(1\)-forms \(\pf_1, \pf_2, \alpha\) coframe.
\begin{problem}{prolongation:int.mfld.to.surf}%
Prove that all integral manifolds coframed by \(\pf_1, \pf_2, \alpha\) are locally frame bundles of isometric immersions.
\end{problem}
\begin{answer}{prolongation:int.mfld.to.surf}
Take an integral manifold \(X\) coframed by \(\pf_1, \pf_2, \alpha\).
We need to prove that every point of \(X\) lies in an open subset of \(X\) which is also an open subset of a frame bundle of an isometric immersion.
Note that \(X\subset M \defeq \frameBundle{S} \times \frameBundleE{3}\).

We use a slightly imprecise notation: the map taking
\[
\pr{x,e_1,e_2,\ot{x},\ot{e}_1,\ot{e}_2,\ot{e}_3}
\mapsto
x
\]
we will simply denote by \(x\), and so on.
At each point 
\[
\pr{x,e_1,e_2,\ot{x},\ot{e}_1,\ot{e}_2,\ot{e}_3}\in X,
\]
the vectors \(e_1,e_2\in T_x S\) are an orthonormal basis of \(T_x S\).
Since  \(\pf_1,\pf_2\) are linearly independent on \(X\), there are vectors tangent to \(X\) on which \(\pf_1,\pf_2\) take any given values.
But \(\pf_1=e_1\cdot dx\) and \(\pf_2=e_2\cdot dx\) measure dot products of \(dx\) with \(e_1,e_2\).
So there are tangent vectors to \(X\) for which the map \(x\colon X\to S\) has differential \(dx\) taking these vectors to have any given values of dot products with \(e_1,e_2\).
Hence \(x\colon X\to S\) has rank \(2\), i.e. full rank, a submersion.
We can replace \(X\) by an open subset of \(X\), and \(S\) by an open subset of \(S\), so that this submersion is a fiber bundle map with connected fibers.
Moreover, \(\pf_1,\pf_2\) vanish just on the directions where \(dx=0\), i.e. the fibers.

On \(X\), \(\qf_1=\pf_1\), \(\qf_2=\pf_2\) and \(\qf_3=0\).
So \(d\ot{x}=0\) just on the tangent vectors to \(X\) on which \(0=\qf_1=\qf_2\), i.e. on which \(0=\pf_1=\pf_2\), i.e. on which \(dx=0\), i.e. on the fibers of \(x\).
So \(\ot{x}\) is constant on each fiber of \(x\).
So \(\ot{x}\) is defined and smooth on the base \(S\) of the fiber bundle map \(x\colon X\to S\), i.e. \(\ot{x}\) factors through \(x\).
Write this factorization as \(\ot{x}=\varphi(x)\), \(\varphi\colon S\to\E[3]\), a commutative diagram of maps:
\[
\begin{tikzcd}
&X\ar["x"]{dl} \ar["\ot{x}"']{dr}&\\
S\ar["\varphi"]{rr}&&\E[3].
\end{tikzcd}
\]
Compute
\begin{align*}
\ot{x}_*
&=
\varphi_* x_*,
\\
&=
\varphi_* \sum_i (e_i \cdot x_*) e_i,
\\
&=
\sum_i \varphi_* e_i (e_i\cdot dx) ,
\\
&=
\sum_i \varphi_* e_i \pf_i.
\end{align*}
But 
\begin{align*}
\ot{x}_*
&=
d\ot{x},
\\
&=
\sum_i (\ot{e}_i \cdot d\ot{x})\ot{e}_i,
\\
&=
\sum_i \ot{e}_i \qf_i,
\\
&=
\sum_i \ot{e}_i \pf_i.
\end{align*}
So finally on \(X\),
\[
\sum_i \ot{e}_i\pf_i=\sum_i \varphi_* e_i \pf_i.
\]
By linear independence of \(\pf_1,\pf_2\):
\[
\ot{e}_i=\varphi_* e_i.
\]
Each point \(x\in S\) lies in the image of  some point
\[
\pr{x,e_1,e_2,\ot{x},\ot{e}_1,\ot{e}_2,\ot{e}_3}\in X
\]
and
\[
\varphi'(x) \colon e_1,e_2\mapsto \ot{e}_1,\ot{e}_2,
\]
so \(\varphi'(x)\) takes some orthonormal basis \(e_1,e_2\) to an orthonormal basis \(\ot{e}_1,\ot{e}_2\).
Hence \(\varphi\) is an isometric immersion.
Moreover, \(X\) consists of isometrically matched orthonormal bases, i.e. \(X\subset X_{\varphi}\), an open subset since both \(X\) and \(X_{\varphi}\) are \(3\)-dimensional submanifolds of \(M\).
\end{answer}
For the moment, we concentrate on asking whether we can apply the Cartan--K\"ahler theorem.
\[
d
\begin{pmatrix}
\theta_1 \\
\theta_2 \\
\theta_3
\end{pmatrix}
=
-%
\Tablo{0,\otalpha-\alpha,0;*-\pr{\otalpha-\alpha},0,0;*-\qc_{13},*-\qc_{23},0}[2,1,0]
\wedge
\begin{pmatrix}
\pf_1 \\
\pf_2 \\
\alpha
\end{pmatrix}
\mod{\theta_1, \theta_2, \theta_3}
\]
Each \(3\)-dimensional integral element has \(\qf=\pf\), so is determined by the linear equations giving \(\qc_1, \qc_2, \qc_3\) in terms of \(\pf_1, \pf_2, \alpha\) on which \(d\theta=0\):
\[
\begin{pmatrix} 
\qc_{13} \\
\qc_{23} \\
\otalpha-\alpha
\end{pmatrix}
=
\begin{pmatrix}
a & b & 0 \\
b & c & 0 \\
0 & 0 & 0
\end{pmatrix} 
\begin{pmatrix}
\pf_1 \\
\pf_2 \\
\alpha
\end{pmatrix}.
\]
Therefore there is a \(3\)-dimensional space of integral elements at each point.
But \(s_1+2s_2=4>3\): not involutive, so we can't apply the Cartan--K\"ahler theorem.
\prob{prolongation:counter}{Is the existence of a \(p\)-dimensional involutive integral element precisely the condition that \(p+s_0+s_1+\dots+s_p\le\dim M\) on every integral element of dimension \(p\)?}
There is another way to look at the failure of involution.
In chapter~\ref{chapter:proof}, we will see that the Cartan--K\"ahler theorem can only apply if the generic integral line sits in an integral plane.
The equations on integral lines are \(\qf_1=\pf_1\), \(\qf_2=\pf_2\), \(\qf_3=0\).
On any integral plane \(\otalpha=\alpha\).
The generic integral line does not sit in an integral plane, because it doesn't have to satisfy \(\otalpha=\alpha\).

\section{What to do?}
On every integral element, we said that
\[
\begin{pmatrix} 
\qc_{13} \\
\qc_{23} \\
\otalpha-\alpha
\end{pmatrix}
=
\begin{pmatrix}
a & b & 0\\
b & c & 0\\
0 & 0 & 0
\end{pmatrix} 
\begin{pmatrix}
\pf_1 \\
\pf_2 \\
\alpha
\end{pmatrix}.
\]
Make a new manifold \(M' \defeq M \times \R[3]_{a,b,c}\), and on \(M'\) let \(\II'\) be the exterior differential system generated by
\begin{align*}
\begin{pmatrix}
\theta_4 \\
\theta_5 \\
\theta_6 
\end{pmatrix}
&\defeq 
\begin{pmatrix}
\qc_{13} \\
\qc_{23} \\
\otalpha-\alpha
\end{pmatrix}
-
\begin{pmatrix}
a & b & 0 \\
b & c & 0 \\
0 & 0 & 0
\end{pmatrix}
\begin{pmatrix}
\pf_1 \\
\pf_2 \\
\alpha
\end{pmatrix}.
\end{align*}


\section{Prolongation}
What should we do if there are no involutive integral elements?
Take an exterior differential system \(\II\) on a manifold \(M\).
We can always suppose, without loss of generality, that all maximal integral elements have the same dimension, say \(p\).
Denote by \(\Gr{p}{M}\) the Grassmann bundle of \(p\)-dimensional linear subspaces of tangent spaces of \(M\).
Take the subset \(M' \subset \Gr{p}{M}\) of all \(p\)-dimensional integral elements.
Cut out any point of \(M'\) near which \(M'\) is not a submanifold of \(\Gr{p}{M}\).
Write out a tableau in \(1\)-forms \(\theta,\omega,\pi\).
Write each linear subspace coframed by \(\omega\) as the solutions of the linear equations \(\pi=p\omega,\theta=q\omega\) for some constants \(p,q\).
On an open subset of \(\Gr{p}{M}\), \(p,q\) are functions valued in some vector spaces.
Pull back the \(1\)-forms \(\theta, \omega, \pi\) to that open subset via the map  \((m,E) \in \Gr{p}{M} \mapsto m \in M\).
The subset \(M'\) is cut out by the equation \(q=0\) and various equations among the \(p\).
On \(M'\), let \(\theta'\defeq\pi-p\omega\)
The exterior differential system \(\II'\) on \(M'\) generated by \(\vartheta'\) is the \emph{prolongation}\define{prolongation} of \(\II\).

More abstractly, without choosing a local basis of \(1\)-forms: a \(1\)-form \(\theta\) on \(\Gr{p}{M}\) is \emph{contact}\define{contact} if, at each point \(E\in\Gr{p}{M}\),  \(\theta_E\) is the pullback of a cotangent vector vanishing on \(E\).
The ideal \(\II'\) is generated by the restrictions to \(M'\) of the contact \(1\)-forms.
Any integral manifold \(X \subset M\) determines an integral manifold \(x \in X \mapsto T_x X \in M'\).
Recall that the \emph{fibers}\define{fiber} of a map are the preimages of points.
All integral manifolds on \(M'\) nowhere tangent to the fibers of \(M' \to M\) arise in this way.

Roughly speaking, prolongation is differentiation:
\prob{prolongation:diff}{Write an exterior differential system associated to the partial differential equation \(u_x=u_{yy}\).
Consider the system of differential equations obtained by differentiating both sides of the equation once in each of the variable:
\[
\begin{tikzcd}[ampersand replacement=\&]
\& u_x=u_{yy} \ar["(\dots)_x"']{dl} \ar["(\dots)_y"]{dr} \& \\
u_{xx}=u_{yyx} \& \& u_{xy}=u_{yyy}
\end{tikzcd}
\]
Explain why the prolongation is associated to that system.}
Some theorems prove that, under some hypotheses, exterior differential systems become involutive after sufficiently many prolongations \cite{BCGGG:1991} p. 255 theorem 3.2, \cite{Malgrange:2005} p. 68 theorem 4.11.

\section{Example: isometric immersion, prolonging}
Returning to our example of isometric immersion of surfaces, prolong:
\begin{align*}
\begin{pmatrix}
  \theta_4 \\
  \theta_5 \\
  \theta_6 
\end{pmatrix}
&\defeq 
\begin{pmatrix}
\qc_{13} \\
\qc_{23} \\
\otalpha-\alpha
\end{pmatrix}
-
\begin{pmatrix}
a & b & 0 \\
b & c & 0 \\
0 & 0 & 0
\end{pmatrix}
\begin{pmatrix}
\pf_1 \\
\pf_2 \\
\alpha
\end{pmatrix}.
\end{align*}
Note that \(0=d\theta_1, d\theta_2, d\theta_3\) modulo \(\theta_4,\theta_5,\theta_6\), so we can forget about them.

Calculate the exterior derivatives:
\[
d
\begin{pmatrix}
  \theta_4 \\
  \theta_5 \\
  \theta_6 
\end{pmatrix}
=
-
\begin{tableau}
\freeDeriv{Da} & Db & 0 \\
\freeDeriv{Db} & \freeDeriv{Dc} & 0 \\
0 & 0 & 0
\end{tableau}
\wedge 
\begin{pmatrix}
  \pf_1 \\
  \pf_2 \\
  \alpha
\end{pmatrix}
+
\begin{pmatrix}
0 \\
0 \\
t \pf_1 \wedge \pf_2
\end{pmatrix}
\mod{\theta_1,\dots,\theta_6}
\]
where 
\[
\begin{pmatrix}
Da \\
Db \\
Dc
\end{pmatrix}
\defeq 
\begin{pmatrix}
da + 2b\alpha + a_1 \pf_1 + a_2 \pf_2, \\
db + (a-c)\alpha + b_1 \pf_1 + b_2 \pf_2, \\
dc + 2b \alpha  + c_1 \pf_1 + c_2 \pf_2,
\end{pmatrix}
\]
where \(a_1,a_2,b_1,b_2,c_1,c_2\) can be chosen as we like, as long as
\begin{align*}
a_2 &= b_1, \\
b_2 &= c_1.
\end{align*}
(We will take advantage of the freedom to choose the remaining \(a_1,b_1,c_1,c_2\) quantities later; see chapter~\ref{chapter:Cauchy.characteristics}.)
The torsion\SubIndex{torsion} is
\[
t\defeq ac-b^2-K.
\]
This torsion clearly has to vanish on any \(3\)-dimensional \(\II'\)-integral element, i.e. every \(3\)-dimensional \(\II'\)-integral element lives over the subset of \(M'\) on which 
\(K=ac-b^2\).
To ensure that this subset is a submanifold, we let \(M'_0 \subset M'\) be the set of points where this equation is satisfied and at least one of \(a,b,c\) is not zero.
Clearly  \(M'_0 \subset M'\) is a submanifold, on which we find \(Da, Db, Dc\) linearly dependent.
On \(M'_0\):
\[
d
\begin{pmatrix}
  \theta_4 \\
  \theta_5 \\
  \theta_6 
\end{pmatrix}
=
-
\Tablo{*Da,Db,0;*Db,Dc,0;0,0,0}[2,0,0]
%\begin{tableau}
%\freeDeriv{Da} & Db & 0 \\
%\freeDeriv{Db} & Dc & 0 \\
%0 & 0 & 0
%\end{tableau}
\wedge 
\begin{pmatrix}
  \pf_1 \\
  \pf_2 \\
  \alpha
\end{pmatrix}
\mod{\theta_1,\dots,\theta_6}.
\]
%\(s_1,s_2=2,0\) and 
There are \(2\) dimensions of integral elements at each point, involution: there is an integral manifold through each point of \(M'_0\), and in particular above every point of the surface.
The prolongation exposes the hidden necessary condition for existence of a solution: the relation \(K=ac-b^2\) between the curvature of the surface and the shape operator.
\prob{bundle.found}{Prove that any integral manifold of the exterior differential system constructed above coframed by \(\omega_1,\omega_2,\alpha\) is locally the frame bundle of a isometric immersion.}
The reader familiar with Riemannian manifolds can easily generalize these computations:
\begin{theorem}
Take any surface \(S\) with Riemannian metric and a point \(x_0 \in S\).
Denote the Gauss curvature by \(K\).
Take any \(3\)-dimensional manifold \(\ot{X}\) with Riemannian metric, a point \(\ot{x}_0\), and a linear isometric injection \(\Phi \colon T_{x_0} S \to T_{\ot{x}_0} \ot{X}\).
Let \(\ot{R}\) be the sectional curvature tensor of \(\ot{X}\) on the image of \(\Phi\).
Pick a nonzero quadratic form \(q\) on the tangent plane \(T_{x_0} S\) so that \(\det q = K - \ot{R}\).
Then there is an isometric immersion \(\varphi\) of some neighborhood of \(x_0\) to \(\ot{X}\), so that \(\varphi'\of{x_0}=\Phi\) and so that \(\varphi\) induces shape operator \(q\) at \(x_0\).
\end{theorem}

\begin{problem}{prolongation:not.rev}
Prove that every sufficiently small spherical cap on the unit sphere admits an isometric embedding to \(\E[3]\) \emph{not} contained in a surface of revolution.
\end{problem}
For more on isometric immersions, see \cite{Han/Hong:2006}.
